<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Card√°pios de Jantar Consolidados (Vota√ß√£o Supabase)</title>
    <!-- Carregando Tailwind CSS CDN para design simples e moderno -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Configura√ß√£o do Tailwind -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'primary-dark': '#1F2937',
                        'primary-light': '#F3F4F6',
                        'accent': '#10B981', // Verde Suave, cor de destaque do Supabase
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    <style>
        /* Estiliza√ß√£o para a tabela de detalhes do menu */
        .menu-table td {
            padding: 8px 12px;
            border-bottom: 1px solid #E5E7EB;
            vertical-align: top;
        }
        .menu-table tr:last-child td {
            border-bottom: none;
        }
        .menu-table th {
            text-align: left;
            font-weight: 600;
            background-color: #F9FAFB;
            padding: 8px 12px;
        }
        .vote-button {
            transition: transform 0.1s ease-in-out, background-color 0.2s;
        }
        .vote-button:hover:not(:disabled) {
            transform: scale(1.05);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        .vote-button:disabled {
            cursor: default;
            opacity: 0.8;
        }
    </style>
</head>
<body class="bg-primary-light font-sans text-gray-800 p-4 sm:p-8">

    <header class="text-center mb-10">
        <h1 class="text-4xl sm:text-5xl font-extrabold text-primary-dark mb-2">
            Compila√ß√£o de Menus de Jantar
        </h1>
        <p class="text-lg text-gray-600 mb-1">
            Vote nos seus pratos favoritos!
        </p>
        <p class="text-md font-bold text-accent mb-4">
            Sistema de vota√ß√£o em tempo real via Supabase.
        </p>
        <p id="status-message" class="text-xs text-gray-500">
            Aguardando inicializa√ß√£o do Supabase...
        </p>
    </header>

    <main id="menus-container" class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-8 max-w-7xl mx-auto">
        <!-- Os cards de menu ser√£o gerados aqui pelo JavaScript -->
    </main>

    <script type="module">
        // Importa o cliente Supabase
        import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm';

        // ====================================================================
        // !!! ATEN√á√ÉO: SUBSTITUA ESSAS CREDENCIAIS PELAS DO SEU PROJETO SUPABASE !!!
        // ====================================================================
        const SUPABASE_URL = 'https://yyayufgoboagvifxanfc.supabase.co'; 
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inl5YXl1ZmdvYm9hZ3ZpZnhhbmZjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQ1MzMzNzksImV4cCI6MjA4MDEwOTM3OX0.fjREIYRCBIVCYNsKFzag2DXi96cavDbRzxblTTUFVDA'; 
        // ====================================================================
        
        let supabase = null;
        let userId = null;
        const statusElement = document.getElementById('status-message');
        const dishVotesTable = 'global_votes'; // Tabela para contagem total de votos
        const userVotesTable = 'user_votes'; // Tabela para rastrear votos do usu√°rio

        // Inicializa√ß√£o do Supabase e obten√ß√£o de ID an√¥nimo
        const initializeSupabase = async () => {
            if (SUPABASE_URL === 'YOUR_SUPABASE_PROJECT_URL' || SUPABASE_ANON_KEY === 'YOUR_SUPABASE_ANON_KEY') {
                statusElement.textContent = "ERRO: Credenciais do Supabase n√£o configuradas. Vota√ß√£o desativada.";
                console.error("ERRO: Por favor, insira a URL e a Chave An√¥nima do seu projeto Supabase.");
                return;
            }

            supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
            
            // Gerar ou recuperar ID an√¥nimo do usu√°rio
            let anonId = localStorage.getItem('anon_user_id');
            if (!anonId) {
                anonId = crypto.randomUUID();
                localStorage.setItem('anon_user_id', anonId);
            }
            userId = anonId;
            statusElement.textContent = `Supabase conectado. ID An√¥nimo: ${userId.substring(0, 8)}...`;

            renderMenus();
            setupGlobalVotesListener();
            await setupUserVotesListener(); // Espera carregar votos antes de finalizar a renderiza√ß√£o dos bot√µes
        };

        // --- Estrutura de Dados dos Menus (mantida) ---

        const menusData = [
            { title: "1. Cl√°ssico Italiano Sofisticado üáÆüáπ", description: "Celebra a culin√°ria italiana com ingredientes frescos e sabores marcantes, apresentados de forma elegante.", courses: [{ course: "Aperitivo", dish: "Grissinis com Pesto de Manjeric√£o e Lim√£o Siciliano" }, { course: "Entrada", dish: "Carpaccio Cl√°ssico com R√∫cula e Lascas de Parmes√£o" }, { course: "Principal", dish: "Saltimbocca de Vitela com S√°lvia e Presunto de Parma" }, { course: "Sobremesa", dish: "Panna Cotta de Baunilha com Coulis de Frutas Vermelhas" }], drinks: [{ type: "Vinho (Tinto M√©dio)", suggestion: "Chianti Classico" }, { type: "Sem √Ålcool", suggestion: "√Ågua aromatizada com laranja, alecrim e lim√£o" }] },
            { title: "2. Sabores do Mediterr√¢neo e do Mar üåä", description: "Leveza, frescor e os aromas da culin√°ria litor√¢nea, com foco em azeites, ervas e frutos do mar.", courses: [{ course: "Aperitivo", dish: "Bruschettas de Tomate Cereja e Queijo Feta" }, { course: "Entrada", dish: "Salada Caprese Desconstru√≠da com Redu√ß√£o Bals√¢mica" }, { course: "Principal", dish: "Peixe Branco Assado com Crosta de Ervas e Risoto de Lim√£o Siciliano" }, { course: "Sobremesa", dish: "Torta Grega de Iogurte com Mel e Nozes" }], drinks: [{ type: "Vinho (Branco Seco)", suggestion: "Sauvignon Blanc" }, { type: "Sem √Ålcool", suggestion: "Limonada su√≠√ßa com manjeric√£o" }] },
            { title: "3. Toques Orientais e Especiarias Suaves ü•¢", description: "Uma jornada com temperos ex√≥ticos, combinando o doce, o salgado e o umami.", courses: [{ course: "Aperitivo", dish: "Edamame Cozido no Vapor com Flor de Sal e Pimenta Togarashi" }, { course: "Entrada", dish: "Rolinhos Primavera Frescos (Summer Rolls) com Molho de Amendoim" }, { course: "Principal", dish: "Curry Tailand√™s Vermelho de Frango com Arroz Jasmim" }, { course: "Sobremesa", dish: "Mousse de Ch√° Matcha e Chocolate Branco" }], drinks: [{ type: "Vinho (Branco Meio Seco)", suggestion: "Riesling ou Gew√ºrztraminer" }, { type: "Sem √Ålcool", suggestion: "Ch√° de Jasmim gelado" }] },
            { title: "4. Conforto R√∫stico Brasileiro Contempor√¢neo üáßüá∑", description: "Sabores familiares da cozinha brasileira, mas com apresenta√ß√£o e t√©cnicas refinadas.", courses: [{ course: "Aperitivo", dish: "Dadinhos de Tapioca com Gel√©ia de Pimenta Artesanal" }, { course: "Entrada", dish: "Caldo de Ab√≥bora Caboti√° com Gengibre e Queijo Coalho Grelhado" }, { course: "Principal", dish: "Carne Seca Desfiada em Moranga (Mini) com Pur√™ de Mandioca" }, { course: "Sobremesa", dish: "Romeu e Julieta Gourmet (Goiabada Cremosa e Mousse de Queijo)" }], drinks: [{ type: "Bebida", suggestion: "Cerveja Lager Premium ou Cacha√ßa Ouro" }, { type: "Sem √Ålcool", suggestion: "Suco de Caju ou Laranja com gengibre" }] },
            { title: "5. Bistr√¥ Franc√™s e Aconchegante üá´üá∑", description: "Menu cl√°ssico da culin√°ria francesa, com prepara√ß√µes que demandam aten√ß√£o, mas oferecem grande satisfa√ß√£o.", courses: [{ course: "Aperitivo", dish: "Queijo Brie Assado com Mel e Am√™ndoas Laminadas" }, { course: "Entrada", dish: "Sopa de Cebola Gratinada (Soupe √† l'Oignon Gratin√©e)" }, { course: "Principal", dish: "B≈ìuf Bourguignon (Carne de Boi Cozida no Vinho Tinto)" }, { course: "Sobremesa", dish: "Cr√®me Br√ªl√©e Cl√°ssico de Baunilha" }], drinks: [{ type: "Vinho (Tinto Leve/M√©dio)", suggestion: "Pinot Noir da Borgonha" }, { type: "Sem √Ålcool", suggestion: "√Ågua com g√°s e xarope de frutas vermelhas" }] },
            { title: "6. Ess√™ncia de Minas üßÄ", description: "Sabores mineiros familiares, com um toque r√∫stico e reconfortante.", courses: [{ course: "Aperitivo", dish: "P√£o de Queijo Recheado com Lingui√ßa Artesanal" }, { course: "Entrada", dish: "Creme de Mandioca com Alho-Por√≥ e Crispies de Bacon" }, { course: "Principal", dish: "Lombo Su√≠no Assado com Redu√ß√£o de Goiabada e Batatas R√∫sticas" }, { course: "Sobremesa", dish: "Tiramis√π de Colher com Caf√© e Doce de Leite" }], drinks: [{ type: "Cerveja", suggestion: "Cerveja Artesanal Vienna Lager ou IPA" }, { type: "Sem √Ålcool", suggestion: "Suco de Goiaba (natural)" }] },
            { title: "7. Fresco e Tropical üçç", description: "Um menu leve e vibrante, perfeito para dias quentes, explorando frutas e peixes.", courses: [{ course: "Aperitivo", dish: "Cubos de Queijo Minas Padr√£o Grelhados com Or√©gano" }, { course: "Entrada", dish: "Salada de Folhas Verdes com Manga e Til√°pia Salteada" }, { course: "Principal", dish: "Medalh√£o de Frango Recheado com Queijo e Presunto" }, { course: "Sobremesa", dish: "Mousse de Maracuj√° com Crocante de Amendoim" }], drinks: [{ type: "Vinho (Branco Leve)", suggestion: "Vinho Verde (Leve e Frisante)" }, { type: "Sem √Ålcool", suggestion: "√Ågua de Coco ou Ch√° Mate com lim√£o" }] },
            { title: "8. Inspira√ß√£o Francesa Descomplicada ü•ê", description: "Cl√°ssicos franceses adaptados para uma execu√ß√£o mais simples e r√°pida.", courses: [{ course: "Aperitivo", dish: "Torradinhas com Pat√™ de Ricota e Ervas" }, { course: "Entrada", dish: "Quiche de Queijo e Presunto em Por√ß√µes Individuais" }, { course: "Principal", dish: "Strogonoff de Carne Bovina com Champignon" }, { course: "Sobremesa", dish: "Cr√®me Caramel (Pudim de Leite Condensado Caseiro)" }], drinks: [{ type: "Vinho", suggestion: "Ros√© Seco (ou um Tinto leve como Gamay)" }, { type: "Sem √Ålcool", suggestion: "Suco de Uva Integral" }] },
            { title: "9. Italiano Simples üçù", description: "Sabores italianos r√∫sticos e f√°ceis de preparar, focando em massas, queijos e empanados.", courses: [{ course: "Aperitivo", dish: "Bolinhas de Queijo Coalho com Tomate Seco no Azeite" }, { course: "Entrada", dish: "Salada de Batata Doce com Molho Pesto de Coentro" }, { course: "Principal", dish: "Fil√© Mignon Su√≠no √† Milanesa (Escalope) com Molho de Lim√£o" }, { course: "Sobremesa", dish: "Semifreddo de Morango e Biscoito" }], drinks: [{ type: "Vinho (Branco Leve)", suggestion: "Pinot Grigio ou Vermentino" }, { type: "Sem √Ålcool", suggestion: "Soda Italiana de Lim√£o e Xarope de Gengibre" }] },
            { title: "10. Um Peda√ßo do Nordeste ‚òÄÔ∏è", description: "Menu com ingredientes e preparos t√≠picos nordestinos, ricos em sabor e tradi√ß√£o.", courses: [{ course: "Aperitivo", dish: "Cuscuz em Mini-Formas com Sardinha" }, { course: "Entrada", dish: "Acaraj√© Desconstru√≠do e Vatap√° de Copo" }, { course: "Principal", dish: "Escondidinho de Carne de Sol Cremoso" }, { course: "Sobremesa", dish: "Doce de Ab√≥bora com Coco e Peda√ßos de Queijo Fresco" }], drinks: [{ type: "Cerveja", suggestion: "Cerveja Pilsen Artesanal (bem gelada)" }, { type: "Sem √Ålcool", suggestion: "Suco de Caj√° ou Mangaba" }] },
            { title: "11. Cl√°ssico Italiano üáÆüáπ (Elegante)", description: "Eleg√¢ncia e acidez equilibrada. Foco em frescor.", courses: [{ course: "Aperitivo", dish: "Bruschetta Cl√°ssica" }, { course: "Entrada", dish: "Salada Caprese Desconstru√≠da" }, { course: "Principal", dish: "Saltimbocca alla Romana" }, { course: "Sobremesa", dish: "Panna Cotta com Calda de Frutas Vermelhas" }], drinks: [{ type: "Vinho (Tinto Seco)", suggestion: "Chianti" }, { type: "Sem √Ålcool", suggestion: "√Ågua com g√°s, lim√£o e hortel√£" }] },
            { title: "12. Franc√™s Elegante üá´üá∑", description: "Focado na t√©cnica e no sabor profundo, para um resultado requintado.", courses: [{ course: "Aperitivo", dish: "Goug√®res (Puffs de Queijo)" }, { course: "Entrada", dish: "Sopa de Cebola Gratinada (Soupe √† l'Oignon Gratin√©e)" }, { course: "Principal", dish: "Frango Assado com Ervas de Provence e Batatas ao Murro" }, { course: "Sobremesa", dish: "Cr√®me Br√ªl√©e Cl√°ssico" }], drinks: [{ type: "Vinho (Branco Seco)", suggestion: "Sancerre" }, { type: "Sem √Ålcool", suggestion: "Ch√° gelado de p√™ssego e camomila" }] },
            { title: "13. Mediterr√¢neo Leve ‚òÄÔ∏è", description: "Prioriza ingredientes frescos e o equil√≠brio entre o √°cido e o salgado.", courses: [{ course: "Aperitivo", dish: "Homus com P√£o Pita Artesanal" }, { course: "Entrada", dish: "Salada Grega (Horiatiki)" }, { course: "Principal", dish: "Peixe Grelhado ao Molho de Lim√£o e Alcaparras" }, { course: "Sobremesa", dish: "Iogurte Grego com Mel e Nozes" }], drinks: [{ type: "Vinho (Branco Leve)", suggestion: "Albari√±o" }, { type: "Sem √Ålcool", suggestion: "Limonada Siciliana" }] },
            { title: "14. Fus√£o e Conforto üå∂Ô∏è", description: "Traz notas levemente picantes e defumadas, focando em pratos reconfortantes.", courses: [{ course: "Aperitivo", dish: "Mini Quiches de Alho-Por√≥" }, { course: "Entrada", dish: "Creme de Ab√≥bora com Gengibre e Cro√ªtons" }, { course: "Principal", dish: "Fil√© Mignon ao Molho de Vinho Tinto e Pur√™ R√∫stico" }, { course: "Sobremesa", dish: "Mousse de Chocolate Amargo com Flor de Sal" }], drinks: [{ type: "Vinho (Tinto M√©dio)", suggestion: "Merlot" }, { type: "Sem √Ålcool", suggestion: "Suco de Cranberry com Gengibre" }] },
            { title: "15. Vegetariano e Texturas üåø", description: "Riqueza de texturas e sabor intenso dos vegetais e cogumelos.", courses: [{ course: "Aperitivo", dish: "Ovos Recheados (Deviled Eggs) com P√°prica Defumada" }, { course: "Entrada", dish: "Torre de Berinjela Caprese (Melanzane a Torretta)" }, { course: "Principal", dish: "Risoto de Cogumelos Frescos" }, { course: "Sobremesa", dish: "Tiramisu Cl√°ssico" }], drinks: [{ type: "Vinho (Tinto Leve)", suggestion: "Pinot Noir" }, { type: "Sem √Ålcool", suggestion: "Suco de Uva Integral gelado" }] }
        ];

        // Vari√°veis de estado
        let globalVotes = {}; // { dishId: count }
        let userVotedDishes = {}; // { dishId: true }


        // --- Fun√ß√µes Auxiliares ---

        /**
         * Gera um ID √∫nico e est√°vel para um prato, baseado no √≠ndice do menu e no curso.
         */
        const generateDishId = (menuIndex, courseName) => {
            const cleanTitle = menusData[menuIndex].title.replace(/[^a-zA-Z0-9]/g, '');
            const cleanCourse = courseName.replace(/[^a-zA-Z0-9]/g, '');
            return `${cleanTitle}_${cleanCourse}`.toLowerCase();
        };

        /**
         * Atualiza a apar√™ncia do bot√£o de voto (cor e texto).
         */
        const updateVoteButtonState = (dishId, hasVoted) => {
            const button = document.getElementById(`button-${dishId}`);
            if (button) {
                if (hasVoted) {
                    button.textContent = '‚ù§Ô∏è Votado';
                    button.classList.remove('bg-gray-100', 'hover:bg-gray-200');
                    button.classList.add('bg-accent', 'text-white');
                    button.disabled = true;
                } else {
                    button.textContent = 'ü§ç Votar';
                    button.classList.remove('bg-accent', 'text-white');
                    button.classList.add('bg-gray-100', 'hover:bg-gray-200');
                    button.disabled = false;
                }
            }
        };


        // --- Fun√ß√µes do Supabase (Substituindo o Firebase) ---

        /**
         * 1. Configura o ouvinte Realtime para os votos globais.
         * Requer uma pol√≠tica de RLS (Row Level Security) que permita SELECT p√∫blico na tabela 'global_votes'.
         */
        const setupGlobalVotesListener = () => {
            if (!supabase) return;

            // Escuta mudan√ßas em tempo real na tabela de votos globais
            supabase
                .channel('public:global_votes')
                .on('postgres_changes', { event: '*', schema: 'public', table: dishVotesTable }, (payload) => {
                    const dishId = payload.new?.dish_id || payload.old?.dish_id;
                    const votes = payload.new?.votes || 0;
                    
                    if (dishId) {
                        globalVotes[dishId] = votes;
                        // Atualiza o contador na UI
                        const counterElement = document.getElementById(`votes-${dishId}`);
                        if (counterElement) {
                            counterElement.textContent = votes;
                        }
                    }
                })
                .subscribe((status) => {
                    if (status === 'SUBSCRIBED') {
                        // Ap√≥s a subscri√ß√£o, carrega o estado inicial
                        loadInitialGlobalVotes();
                    }
                });
        };

        /**
         * Carrega o estado inicial de todos os votos globais (necess√°rio antes do Realtime).
         */
        const loadInitialGlobalVotes = async () => {
            if (!supabase) return;
            const { data, error } = await supabase
                .from(dishVotesTable)
                .select('dish_id, votes');
            
            if (error) {
                console.error("Erro ao carregar votos globais iniciais:", error);
                return;
            }

            data.forEach(item => {
                globalVotes[item.dish_id] = item.votes;
                const counterElement = document.getElementById(`votes-${item.dish_id}`);
                if (counterElement) {
                    counterElement.textContent = item.votes;
                }
            });
        };


        /**
         * 2. Carrega o hist√≥rico de votos do usu√°rio an√¥nimo.
         * Requer uma pol√≠tica de RLS que permita SELECT com filtro user_id.
         */
        const setupUserVotesListener = async () => {
            if (!supabase || !userId) return;

            const { data, error } = await supabase
                .from(userVotesTable)
                .select('dish_id')
                .eq('user_id', userId);

            if (error) {
                console.error("Erro ao carregar votos do usu√°rio:", error);
                return;
            }
            
            userVotedDishes = {};
            data.forEach(item => {
                userVotedDishes[item.dish_id] = true;
                updateVoteButtonState(item.dish_id, true);
            });
        };


        /**
         * 3. Fun√ß√£o principal de vota√ß√£o.
         * Garante que o usu√°rio vote apenas uma vez (verificando a tabela user_votes)
         * e incrementa o contador global.
         */
        window.handleVote = async (dishId) => {
            if (!supabase || !userId) {
                console.error("Supabase n√£o inicializado ou ID do usu√°rio ausente.");
                return;
            }

            if (userVotedDishes[dishId]) {
                console.log("Usu√°rio j√° votou neste prato.");
                return;
            }

            const button = document.getElementById(`button-${dishId}`);
            if (button) button.disabled = true; // Desabilita temporariamente

            try {
                // Tenta registrar o voto na tabela de hist√≥rico do usu√°rio
                const { error: insertError } = await supabase
                    .from(userVotesTable)
                    .insert([
                        { user_id: userId, dish_id: dishId }
                    ]);

                if (insertError) {
                    // Se o erro for de duplicidade (√∫nico constraint), apenas ignora e sai.
                    // Caso contr√°rio, registra o erro.
                    if (insertError.code === '23505') { // C√≥digo de erro SQL para Unique Violation
                        console.log("Voto duplicado detectado (Unique Constraint).");
                    } else {
                        throw insertError;
                    }
                }

                // Incrementa o voto na tabela global.
                // Esta opera√ß√£o faz um UPSERT (cria se n√£o existir, atualiza se existir).
                // O incremento real deve ser feito no backend via `rpc` ou `trigger`, mas 
                // para o exemplo simples, simulamos com um update otimista ou relying on a trigger.
                
                // Op√ß√£o 1: Uso de RPC (fun√ß√£o do Supabase) - Mais seguro.
                // NOTE: Voc√™ precisaria criar a fun√ß√£o `increment_vote` no seu Supabase:
                /*
                const { error: rpcError } = await supabase.rpc('increment_vote', {
                    p_dish_id: dishId
                });
                if (rpcError) throw rpcError;
                */
                
                // Op√ß√£o 2: Update otimista (simples, mas menos at√¥mico)
                const currentVotes = globalVotes[dishId] || 0;
                const { error: updateError } = await supabase
                    .from(dishVotesTable)
                    .upsert({ 
                        dish_id: dishId, 
                        votes: currentVotes + 1 // Incremento otimista, Realtime corrige.
                    }, { onConflict: 'dish_id' });
                
                if (updateError) throw updateError;


                // Sucesso: atualiza o estado local e o bot√£o
                userVotedDishes[dishId] = true;
                updateVoteButtonState(dishId, true);
                
                // A contagem global ser√° atualizada automaticamente pelo Realtime Listener
                
            } catch (error) {
                console.error("Erro ao votar:", error);
                // Reabilita o bot√£o em caso de falha (exceto se for duplicidade, onde j√° desabilitamos)
                updateVoteButtonState(dishId, userVotedDishes[dishId] || false);
                alert(`Erro ao registrar voto. Verifique a configura√ß√£o do Supabase e as pol√≠ticas de RLS. Detalhe: ${error.message}`);
            }
        };


        // --- Renderiza√ß√£o do HTML (Com Ajuste de Layout) ---

        const menusContainer = document.getElementById('menus-container');

        const renderMenus = () => {
            menusContainer.innerHTML = '';
            menusData.forEach((menu, menuIndex) => {
                
                let coursesHtml = '';
                menu.courses.forEach(item => {
                    const dishId = generateDishId(menuIndex, item.course);
                    
                    // --- NOVO LAYOUT: Voto ABAIXO do Prato ---
                    coursesHtml += `
                        <tr class="dish-row" data-dish-id="${dishId}">
                            <!-- Coluna do Tipo de Prato -->
                            <td class="font-semibold w-1/4 text-primary-dark">${item.course}</td>
                            
                            <!-- Coluna do Prato + Vota√ß√£o (Empilhados Verticalmente) -->
                            <td class="w-3/4">
                                <div class="font-medium text-gray-800 mb-1">${item.dish}</div>
                                
                                <div class="flex items-center space-x-3 mt-1">
                                    <!-- Bot√£o de Voto -->
                                    <button
                                        id="button-${dishId}"
                                        onclick="handleVote('${dishId}')"
                                        class="vote-button text-xs font-semibold p-1 px-2 rounded-lg bg-gray-100 hover:bg-gray-200 text-gray-700 disabled:opacity-50 disabled:cursor-default whitespace-nowrap"
                                        aria-label="Votar no prato ${item.dish}"
                                    >
                                        ü§ç Votar
                                    </button>
                                    <!-- Contador de Votos (Exibi√ß√£o em tempo real) -->
                                    <div class="flex items-center text-sm font-bold text-gray-600">
                                        <span id="votes-${dishId}" class="w-4 text-left text-accent">0</span>
                                        <span class="text-xs text-gray-500">votos</span>
                                    </div>
                                </div>
                            </td>
                        </tr>
                    `;
                    // --- FIM DO NOVO LAYOUT ---
                });

                // Cria√ß√£o da tabela de bebidas
                const drinksTable = menu.drinks.map(item => `
                    <tr>
                        <td class="font-medium w-2/5 text-gray-700">${item.type}</td>
                        <td class="w-3/5 text-gray-600 font-medium">${item.suggestion}</td>
                    </tr>
                `).join('');


                const menuCard = `
                    <div class="bg-white rounded-xl shadow-lg hover:shadow-xl transition duration-300 overflow-hidden border-t-4 border-accent p-6 flex flex-col">
                        <!-- T√≠tulo e Descri√ß√£o -->
                        <div class="mb-4">
                            <h2 class="text-2xl font-bold text-primary-dark mb-1">${menu.title}</h2>
                            <p class="text-sm text-gray-500 italic">${menu.description}</p>
                        </div>

                        <!-- Detalhes dos Pratos e Vota√ß√£o -->
                        <div class="mb-6 flex-grow">
                            <h3 class="text-lg font-semibold text-gray-700 border-b pb-1 mb-2">Pratos</h3>
                            <table class="w-full menu-table text-sm">
                                <tbody>
                                    ${coursesHtml}
                                </tbody>
                            </table>
                        </div>

                        <!-- Sugest√£o de Bebidas -->
                        <div class="pt-4 border-t border-gray-200">
                            <h3 class="text-lg font-semibold text-gray-700 border-b pb-1 mb-2">Harmoniza√ß√£o Sugerida</h3>
                            <table class="w-full menu-table text-sm">
                                <tbody>
                                    ${drinksTable}
                                </tbody>
                            </table>
                        </div>
                    </div>
                `;
                menusContainer.innerHTML += menuCard;
            });
        };
        
        // Inicia a aplica√ß√£o
        initializeSupabase();

    </script>
</body>
</html>